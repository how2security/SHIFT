#!/usr/bin/env python
# -*- coding: utf-8 -*-

'''
Author: Wellington Silva a.k.a. Well
Date: July 2017
Name: utf_32.py
Purpose: Class Encode/Decode with UFT-16.
Description: Script Based on script CAL9000 by Chris Loomis from OWASP Project, posted at:
                     <https://www.owasp.org/index.php/Category:OWASP_CAL9000_Project>
Version: 1.0B
Licence: GPLv3
 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.
 
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 
 You should have received a copy of the GNU General Public License
 along with this program.  If not, see <http://www.gnu.org/licenses/>.

Other itens: Copyright (c) 2017, How2Security All rights reserved.
'''

class CodingUTF32:
    def __init__(self, mystring):
        self.mystring = mystring
	# Encode UTF-32
        self.utf32 = { r'\xff\xfe\x00\x00\x00\x00\x00\x00' : '', r'\xff\xfe\x00\x00\x20\x00\x00\x00' : r' ', r'\xff\xfe\x00\x00\x21\x00\x00\x00' : r'!', r'\xff\xfe\x00\x00\x22\x00\x00\x00' : r'"', r'\xff\xfe\x00\x00\x23\x00\x00\x00' : r'#', r'\xff\xfe\x00\x00\x24\x00\x00\x00' : r'$', r'\xff\xfe\x00\x00\x25\x00\x00\x00' : r'%', r'\xff\xfe\x00\x00\x26\x00\x00\x00' : r'&', r'\xff\xfe\x00\x00\x27\x00\x00\x00' : r"'", r'\xff\xfe\x00\x00\x28\x00\x00\x00' : r'(', r'\xff\xfe\x00\x00\x29\x00\x00\x00' : r')', r'\xff\xfe\x00\x00\x2A\x00\x00\x00' : r'*', r'\xff\xfe\x00\x00\x2B\x00\x00\x00' : r'+', r'\xff\xfe\x00\x00\x2C\x00\x00\x00' : r',', r'\xff\xfe\x00\x00\x2D\x00\x00\x00' : r'-', r'\xff\xfe\x00\x00\x2E\x00\x00\x00' : r'.', r'\xff\xfe\x00\x00\x2F\x00\x00\x00' : r'/', r'\xff\xfe\x00\x00\x30\x00\x00\x00' : r'0', r'\xff\xfe\x00\x00\x31\x00\x00\x00' : r'1', r'\xff\xfe\x00\x00\x32\x00\x00\x00' : r'2', r'\xff\xfe\x00\x00\x33\x00\x00\x00' : r'3', r'\xff\xfe\x00\x00\x34\x00\x00\x00' : r'4', r'\xff\xfe\x00\x00\x35\x00\x00\x00' : r'5', r'\xff\xfe\x00\x00\x36\x00\x00\x00' : r'6', r'\xff\xfe\x00\x00\x37\x00\x00\x00' : r'7', r'\xff\xfe\x00\x00\x38\x00\x00\x00' : r'8', r'\xff\xfe\x00\x00\x39\x00\x00\x00' : r'9', r'\xff\xfe\x00\x00\x3A\x00\x00\x00' : r':', r'\xff\xfe\x00\x00\x3B\x00\x00\x00' : r';', r'\xff\xfe\x00\x00\x3C\x00\x00\x00' : r'<', r'\xff\xfe\x00\x00\x3D\x00\x00\x00' : r'=', r'\xff\xfe\x00\x00\x3E\x00\x00\x00' : r'>', r'\xff\xfe\x00\x00\x3F\x00\x00\x00' : r'?', r'\xff\xfe\x00\x00\x40\x00\x00\x00' : r'@', r'\xff\xfe\x00\x00\x41\x00\x00\x00' : r'A', r'\xff\xfe\x00\x00\x42\x00\x00\x00' : r'B', r'\xff\xfe\x00\x00\x43\x00\x00\x00' : r'C', r'\xff\xfe\x00\x00\x44\x00\x00\x00' : r'D', r'\xff\xfe\x00\x00\x45\x00\x00\x00' : r'E', r'\xff\xfe\x00\x00\x46\x00\x00\x00' : r'F', r'\xff\xfe\x00\x00\x47\x00\x00\x00' : r'G', r'\xff\xfe\x00\x00\x48\x00\x00\x00' : r'H', r'\xff\xfe\x00\x00\x49\x00\x00\x00' : r'I', r'\xff\xfe\x00\x00\x4A\x00\x00\x00' : r'J', r'\xff\xfe\x00\x00\x4B\x00\x00\x00' : r'K', r'\xff\xfe\x00\x00\x4C\x00\x00\x00' : r'L', r'\xff\xfe\x00\x00\x4D\x00\x00\x00' : r'M', r'\xff\xfe\x00\x00\x4E\x00\x00\x00' : r'N', r'\xff\xfe\x00\x00\x4F\x00\x00\x00' : r'O', r'\xff\xfe\x00\x00\x50\x00\x00\x00' : r'P', r'\xff\xfe\x00\x00\x51\x00\x00\x00' : r'Q', r'\xff\xfe\x00\x00\x52\x00\x00\x00' : r'R', r'\xff\xfe\x00\x00\x53\x00\x00\x00' : r'S', r'\xff\xfe\x00\x00\x54\x00\x00\x00' : r'T', r'\xff\xfe\x00\x00\x55\x00\x00\x00' : r'U', r'\xff\xfe\x00\x00\x56\x00\x00\x00' : r'V', r'\xff\xfe\x00\x00\x57\x00\x00\x00' : r'W', r'\xff\xfe\x00\x00\x58\x00\x00\x00' : r'X', r'\xff\xfe\x00\x00\x59\x00\x00\x00' : r'Y', r'\xff\xfe\x00\x00\x5A\x00\x00\x00' : r'Z', r'\xff\xfe\x00\x00\x5B\x00\x00\x00' : r'[', r'\xff\xfe\x00\x00\x5C\x00\x00\x00' : r'\\', r'\xff\xfe\x00\x00\x5D\x00\x00\x00' : r'[', r'\xff\xfe\x00\x00\x5E\x00\x00\x00' : r'^', r'\xff\xfe\x00\x00\x5F\x00\x00\x00' : r'_', r'\xff\xfe\x00\x00\x60\x00\x00\x00' : r'`', r'\xff\xfe\x00\x00\x61\x00\x00\x00' : r'a', r'\xff\xfe\x00\x00\x62\x00\x00\x00' : r'b', r'\xff\xfe\x00\x00\x63\x00\x00\x00' : r'c', r'\xff\xfe\x00\x00\x64\x00\x00\x00' : r'd', r'\xff\xfe\x00\x00\x65\x00\x00\x00' : r'e', r'\xff\xfe\x00\x00\x66\x00\x00\x00' : r'f', r'\xff\xfe\x00\x00\x67\x00\x00\x00' : r'g', r'\xff\xfe\x00\x00\x68\x00\x00\x00' : r'h', r'\xff\xfe\x00\x00\x69\x00\x00\x00' : r'i', r'\xff\xfe\x00\x00\x6A\x00\x00\x00' : r'j', r'\xff\xfe\x00\x00\x6B\x00\x00\x00' : r'k', r'\xff\xfe\x00\x00\x6C\x00\x00\x00' : r'l', r'\xff\xfe\x00\x00\x6D\x00\x00\x00' : r'm', r'\xff\xfe\x00\x00\x6E\x00\x00\x00' : r'n', r'\xff\xfe\x00\x00\x6F\x00\x00\x00' : r'o', r'\xff\xfe\x00\x00\x70\x00\x00\x00' : r'p', r'\xff\xfe\x00\x00\x71\x00\x00\x00' : r'q', r'\xff\xfe\x00\x00\x72\x00\x00\x00' : r'r', r'\xff\xfe\x00\x00\x73\x00\x00\x00' : r's', r'\xff\xfe\x00\x00\x74\x00\x00\x00' : r't', r'\xff\xfe\x00\x00\x75\x00\x00\x00' : r'u', r'\xff\xfe\x00\x00\x76\x00\x00\x00' : r'v', r'\xff\xfe\x00\x00\x77\x00\x00\x00' : r'w', r'\xff\xfe\x00\x00\x78\x00\x00\x00' : r'x', r'\xff\xfe\x00\x00\x79\x00\x00\x00' : r'y', r'\xff\xfe\x00\x00\x7A\x00\x00\x00' : r'z', r'\xff\xfe\x00\x00\x7B\x00\x00\x00' : r'{', r'\xff\xfe\x00\x00\x7C\x00\x00\x00' : r'|', r'\xff\xfe\x00\x00\x7D\x00\x00\x00' : r'}', r'\xff\xfe\x00\x00\x7E\x00\x00\x00' : r'~', r'\xff\xfe\x00\x00\x80\x00\x00\x00' : r'€', r'\xff\xfe\x00\x00\xA0\x00\x00\x00' : r' ', r'\xff\xfe\x00\x00\xA1\x00\x00\x00' : r'¡', r'\xff\xfe\x00\x00\xA2\x00\x00\x00' : r'¢', r'\xff\xfe\x00\x00\xA3\x00\x00\x00' : r'£', r'\xff\xfe\x00\x00\xA4\x00\x00\x00' : r'¤', r'\xff\xfe\x00\x00\xA5\x00\x00\x00' : r'¥', r'\xff\xfe\x00\x00\xA6\x00\x00\x00' : r'¦', r'\xff\xfe\x00\x00\xA7\x00\x00\x00' : r'§', r'\xff\xfe\x00\x00\xA8\x00\x00\x00' : r'¨', r'\xff\xfe\x00\x00\xA9\x00\x00\x00' : r'©', r'\xff\xfe\x00\x00\xAA\x00\x00\x00' : r'ª', r'\xff\xfe\x00\x00\xAB\x00\x00\x00' : r'«', r'\xff\xfe\x00\x00\xAC\x00\x00\x00' : r'¬', r'\xff\xfe\x00\x00\xAD\x00\x00\x00' : r'¬', r'\xff\xfe\x00\x00\xAE\x00\x00\x00' : r'®', r'\xff\xfe\x00\x00\xAF\x00\x00\x00' : r'¯', r'\xff\xfe\x00\x00\xB0\x00\x00\x00' : r'°', r'\xff\xfe\x00\x00\xB1\x00\x00\x00' : r'±', r'\xff\xfe\x00\x00\xB2\x00\x00\x00' : r'²', r'\xff\xfe\x00\x00\xB3\x00\x00\x00' : r'³', r'\xff\xfe\x00\x00\xB4\x00\x00\x00' : r'´', r'\xff\xfe\x00\x00\xB5\x00\x00\x00' : r'µ', r'\xff\xfe\x00\x00\xB6\x00\x00\x00' : r'¶', r'\xff\xfe\x00\x00\xB7\x00\x00\x00' : r'•', r'\xff\xfe\x00\x00\xB8\x00\x00\x00' : r'¸', r'\xff\xfe\x00\x00\xB9\x00\x00\x00' : r'¹', r'\xff\xfe\x00\x00\xBA\x00\x00\x00' : r'º', r'\xff\xfe\x00\x00\xBB\x00\x00\x00' : r'»', r'\xff\xfe\x00\x00\xBC\x00\x00\x00' : r'¼', r'\xff\xfe\x00\x00\xBD\x00\x00\x00' : r'½', r'\xff\xfe\x00\x00\xBE\x00\x00\x00' : r'¾', r'\xff\xfe\x00\x00\xBF\x00\x00\x00' : r'¿', r'\xff\xfe\x00\x00\xC0\x00\x00\x00' : r'À', r'\xff\xfe\x00\x00\xC1\x00\x00\x00' : r'Á', r'\xff\xfe\x00\x00\xC2\x00\x00\x00' : r'Â', r'\xff\xfe\x00\x00\xC3\x00\x00\x00' : r'Ã', r'\xff\xfe\x00\x00\xC4\x00\x00\x00' : r'Ä', r'\xff\xfe\x00\x00\xC5\x00\x00\x00' : r'Å', r'\xff\xfe\x00\x00\xC6\x00\x00\x00' : r'Æ', r'\xff\xfe\x00\x00\xC7\x00\x00\x00' : r'Ç', r'\xff\xfe\x00\x00\xC8\x00\x00\x00' : r'È', r'\xff\xfe\x00\x00\xC9\x00\x00\x00' : r'É', r'\xff\xfe\x00\x00\xCA\x00\x00\x00' : r'Ê', r'\xff\xfe\x00\x00\xCB\x00\x00\x00' : r'Ë', r'\xff\xfe\x00\x00\xCC\x00\x00\x00' : r'Ì', r'\xff\xfe\x00\x00\xCD\x00\x00\x00' : r'Í', r'\xff\xfe\x00\x00\xCE\x00\x00\x00' : r'Î', r'\xff\xfe\x00\x00\xCF\x00\x00\x00' : r'Ï', r'\xff\xfe\x00\x00\xD0\x00\x00\x00' : r'Ð', r'\xff\xfe\x00\x00\xD1\x00\x00\x00' : r'Ñ', r'\xff\xfe\x00\x00\xD2\x00\x00\x00' : r'Ò', r'\xff\xfe\x00\x00\xD3\x00\x00\x00' : r'Ó', r'\xff\xfe\x00\x00\xD4\x00\x00\x00' : r'Ô', r'\xff\xfe\x00\x00\xD5\x00\x00\x00' : r'Õ', r'\xff\xfe\x00\x00\xD6\x00\x00\x00' : r'Ö', r'\xff\xfe\x00\x00\xD7\x00\x00\x00' : r'×', r'\xff\xfe\x00\x00\xD8\x00\x00\x00' : r'Ø', r'\xff\xfe\x00\x00\xD9\x00\x00\x00' : r'Ù', r'\xff\xfe\x00\x00\xDA\x00\x00\x00' : r'Ú', r'\xff\xfe\x00\x00\xDB\x00\x00\x00' : r'Û', r'\xff\xfe\x00\x00\xDC\x00\x00\x00' : r'Ü', r'\xff\xfe\x00\x00\xDD\x00\x00\x00' : r'Ý', r'\xff\xfe\x00\x00\xDE\x00\x00\x00' : r'Þ', r'\xff\xfe\x00\x00\xDF\x00\x00\x00' : r'ß', r'\xff\xfe\x00\x00\xE0\x00\x00\x00' : r'à', r'\xff\xfe\x00\x00\xE1\x00\x00\x00' : r'á', r'\xff\xfe\x00\x00\xE2\x00\x00\x00' : r'â', r'\xff\xfe\x00\x00\xE3\x00\x00\x00' : r'ã', r'\xff\xfe\x00\x00\xE4\x00\x00\x00' : r'ä', r'\xff\xfe\x00\x00\xE5\x00\x00\x00' : r'å', r'\xff\xfe\x00\x00\xE6\x00\x00\x00' : r'æ', r'\xff\xfe\x00\x00\xE7\x00\x00\x00' : r'ç', r'\xff\xfe\x00\x00\xE8\x00\x00\x00' : r'è', r'\xff\xfe\x00\x00\xE9\x00\x00\x00' : r'é', r'\xff\xfe\x00\x00\xEA\x00\x00\x00' : r'ê', r'\xff\xfe\x00\x00\xEB\x00\x00\x00' : r'ë', r'\xff\xfe\x00\x00\xEC\x00\x00\x00' : r'ì', r'\xff\xfe\x00\x00\xED\x00\x00\x00' : r'í', r'\xff\xfe\x00\x00\xEE\x00\x00\x00' : r'î', r'\xff\xfe\x00\x00\xEF\x00\x00\x00' : r'ï', r'\xff\xfe\x00\x00\xF0\x00\x00\x00' : r'ð', r'\xff\xfe\x00\x00\xF1\x00\x00\x00' : r'ñ', r'\xff\xfe\x00\x00\xF2\x00\x00\x00' : r'ò', r'\xff\xfe\x00\x00\xF3\x00\x00\x00' : r'ó', r'\xff\xfe\x00\x00\xF4\x00\x00\x00' : r'ô', r'\xff\xfe\x00\x00\xF5\x00\x00\x00' : r'õ', r'\xff\xfe\x00\x00\xF6\x00\x00\x00' : r'ö', r'\xff\xfe\x00\x00\xF7\x00\x00\x00' : r'÷', r'\xff\xfe\x00\x00\xF8\x00\x00\x00' : r'ø', r'\xff\xfe\x00\x00\xF9\x00\x00\x00' : r'ù', r'\xff\xfe\x00\x00\xFA\x00\x00\x00' : r'ú', r'\xff\xfe\x00\x00\xFB\x00\x00\x00' : r'û', r'\xff\xfe\x00\x00\xFC\x00\x00\x00' : r'ü', r'\xff\xfe\x00\x00\xFD\x00\x00\x00' : r'ý', r'\xff\xfe\x00\x00\xFE\x00\x00\x00' : r'þ', r'\xff\xfe\x00\x00\xFF\x00\x00\x00' : r'ÿ' }

    def decoded(self):
        answer = self.mystring
        for i in self.mystring:
            for i, j in self.utf32.iteritems():
                answer = answer.replace(i, j)
        return answer

    def encoded(self):
        answer = ''
        for i in self.mystring:
            for k in self.utf16:
                if i in self.utf32[k]:
                    answer += k
                    break
            else:
                answer += i
        return answer
